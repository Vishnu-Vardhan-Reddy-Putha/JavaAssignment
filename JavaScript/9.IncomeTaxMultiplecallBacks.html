<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Income Tax Calculator (Multiple Callbacks)</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 600px;
      margin: auto;
    }
    h1 {
      font-weight: bold;
      font-size: 1.5rem;
      margin-bottom: 0.3em;
    }
    label {
      display: block;
      margin: 10px 0 5px;
      font-weight: bold;
    }
    input[type="text"], input[type="number"] {
      width: 100%;
      padding: 8px;
      font-size: 1rem;
      box-sizing: border-box;
    }
    button {
      margin-top: 15px;
      padding: 10px 15px;
      font-size: 1rem;
      cursor: pointer;
    }
    #result {
      margin-top: 20px;
      padding: 10px;
      background: #eef;
      border-radius: 5px;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>
  <h1>Income Tax Calculator (Multiple Callbacks)</h1>

  <form id="taxForm">
    <label for="name">Name:</label>
    <input type="text" id="name" required />

    <label for="pan">PAN:</label>
    <input type="text" id="pan" maxlength="10" required />

    <label for="income">Annual Income (₹):</label>
    <input type="number" id="income" min="0" required />

    <button type="submit">Calculate Tax</button>
  </form>

  <div id="result"></div>

  <script>
    // JSON array to store records
    const taxRecords = [];

    // Tax slab calculator function (example slabs)
    function calculateTaxSlab(income) {
      let tax = 0;
      if (income <= 250000) {
        tax = 0;
      } else if (income <= 500000) {
        tax = (income - 250000) * 0.05;
      } else if (income <= 1000000) {
        tax = 12500 + (income - 500000) * 0.2;
      } else {
        tax = 112500 + (income - 1000000) * 0.3;
      }
      return Math.round(tax);
    }

    // Callback 1: Log to console
    function logToConsole(details) {
      console.log("Tax Calculation Details:");
      console.log(`Name: ${details.name}`);
      console.log(`PAN: ${details.pan}`);
      console.log(`Annual Income: ₹${details.income}`);
      console.log(`Calculated Tax: ₹${details.tax}`);
    }

    // Callback 2: Display on page
    function displayOnPage(details) {
      const resultDiv = document.getElementById("result");
      resultDiv.textContent = `
Name: ${details.name}
PAN: ${details.pan}
Annual Income: ₹${details.income}
Calculated Tax: ₹${details.tax}
      `.trim();
    }

    // Callback 3: Save to JSON records
    function saveToRecords(details) {
      taxRecords.push(details);
      // Optionally log the updated records array for debug
      console.log("Updated Tax Records:", taxRecords);
    }

    // Main function to calculate tax and execute callbacks
    function calculateTax(name, pan, income, callback) {
      const tax = calculateTaxSlab(income);
      const details = { name, pan, income, tax };
      callback(details);
    }

    // On form submit
    document.getElementById("taxForm").addEventListener("submit", function(event) {
      event.preventDefault();

      const name = document.getElementById("name").value.trim();
      const pan = document.getElementById("pan").value.trim();
      const income = Number(document.getElementById("income").value);

      if (!name || !pan || isNaN(income) || income < 0) {
        alert("Please fill all fields correctly.");
        return;
      }

      // Calculate tax and run multiple callbacks inside one main callback
      calculateTax(name, pan, income, function(details) {
        logToConsole(details);
        displayOnPage(details);
        saveToRecords(details);
      });
    });
  </script>
</body>
</html>
